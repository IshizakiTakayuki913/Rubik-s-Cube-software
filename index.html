<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>sample</title>
    
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.8thwall.com/web/aframe/aframe-extras-6.1.1.min.js">
      
    </script><!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y3XZ7NZFCZ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      console.log(window.dataLayer)
      gtag('js', new Date());
    
      gtag('config', 'G-Y3XZ7NZFCZ');
    </script>
    
    <script src="./solve.js"></script>
    <script src="./solve2.js"></script>
    <script src="./camera.js"></script>
    <script src="./cubeTouch.js"></script>
    <script src="./syncuser.js"></script>


    <link rel="stylesheet" href="./style.css">
    <link rel="shortcut icon" href="">
  </head>

  <script type="text/javascript">
    let dialogButton = undefined
    AFRAME.registerComponent('press-key-board', presskeyboard())
    AFRAME.registerComponent('camera-view', camera())
    AFRAME.registerComponent('cube-mode', cubemode())
    AFRAME.registerComponent('sync-user', syncuser())

    AFRAME.registerComponent('model-load',{
      schema: {
        modelType: {type: 'string', default: ""},
      },
      init(){
        this.parts = [
          document.getElementById("center").children[5].children[0],
          document.getElementById("edge").children[11].children[0],
          document.getElementById("corner").children[7].children[0],
        ]
        this.loadedCount=0
        for(let i=0;i<3;i++){
          console.log(this.parts[i])
          this.parts[i].addEventListener('model-loaded',(e)=>{
            this.loadedCount++
            if(this.loadedCount==3){
              color_set(scrambled_state)
              this.el.object3D.visible = true
            }
          })
        }
      },
    })
    
  </script>
<!--  onpaste="return false" oncontextmenu="return false" -->
  <body oncontextmenu="return false;" style="background-color: #000">
    <a-scene id="scene"
      renderer="sortObjects: true"
      embedded 
      press-key-board
      cube-mode
      xr-mode-ui="enabled: false"
      keyboard-shortcuts="enterVR: false; exitVR: false"
      device-orientation-permission-ui="enabled: false"
    >
    <!-- 
      debug
      loading-screen
      stats
    -->
<a-assets >
  <a-asset-item id="model_hand"   src="./sub-hand.glb"></a-asset-item>
  <a-asset-item id="model_corner" src="./corner.glb"></a-asset-item>
  <a-asset-item id="model_edge"   src="./edge.glb"></a-asset-item>
  <a-asset-item id="model_center" src="./center.glb"></a-asset-item>

  <a-mixin id="m_ce" gltf-model="#model_center"></a-mixin>
  <a-mixin id="m_e" gltf-model="#model_edge"></a-mixin>
  <a-mixin id="m_c" gltf-model="#model_corner"></a-mixin>
  <a-mixin 
    id="m_normal"
    scale="1 1 1"
    shadow="receive: false">
  </a-mixin>

  
</a-assets>

<a-entity id="root" position="0 0 0" rotation="0 0 0" model-load visible="false">

  <a-entity
    id="L-hand"
    position="0 0 0"
    rotation="0 -90 0"
    gltf-model="#model_hand"
    Amaterial="opacity:0.1; transparent: true"
    animation-mixer="clip: Idole; loop: repeat"
    scale="2.2 2.2 2.2"
    shadow="receive: false"
    visible="false">
  </a-entity>

  <a-entity
    id="R-hand"
    position="0 0 0"
    rotation="0 90 0"
    gltf-model="#model_hand"
    animation-mixer="clip: Idole; loop: repeat"
    scale="-2.2 2.2 2.2"
    shadow="receive: false"
    visible="false">
  </a-entity>

  <a-entity id="center" position="0 0 0">
    <a-entity id="center0" position="0 0 0">
      <a-entity
        rotation="0 180 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
        
    <a-entity id="center1" position="0 0 0">
      <a-entity
        rotation="0 90 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
      
    <a-entity id="center2" position="0 0 0">
      <a-entity
        rotation="0 0 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
      
    <a-entity id="center3" position="0 0 0">
      <a-entity
        rotation="0 -90 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
      
    <a-entity id="center4" position="0 0 0">
      <a-entity
        rotation="-90 0 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
      
    <a-entity id="center5" position="0 0 0">
      <a-entity
        rotation="90 0 0"
        mixin="m_ce m_normal"
        class="clickable">
      </a-entity>
    </a-entity>    
  </a-entity>
  <!-- model-load = "modelType: center"
    model-load = "modelType: edge"
    model-load = "modelType: corner" -->

  <a-entity id="edge" position="0 0 0">
    <a-entity id="edge0" position="0 0 0">
      <a-entity
        rotation="0 -90 90"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge1" position="0 0 0">
      <a-entity
        rotation="0 90 -90"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge2" position="0 0 0">
      <a-entity
        rotation="0 90 90"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="edge3" position="0 0 0">
      <a-entity
        rotation="0 -90 -90"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge4" position="0 0 0">
      <a-entity
        rotation="0 180 0"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="edge5" position="0 0 0">
      <a-entity
        rotation="0 90 0"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge6" position="0 0 0">
      <a-entity
        rotation="0 0 0"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="edge7" position="0 0 0">
      <a-entity
        rotation="0 -90 0"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge8" position="0 0 0">
      <a-entity
        rotation="0 180 180"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
    
    <a-entity id="edge9" position="0 0 0">
      <a-entity
        rotation="0 90 180"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="edge10" position="0 0 0">
      <a-entity
        rotation="0 0 180"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="edge11" position="0 0 0">
      <a-entity
        rotation="0 -90 180"
        mixin="m_e m_normal"
        class="clickable">
      </a-entity>
    </a-entity>
  </a-entity>

  <a-entity id="corner" position="0 0 0">
    <a-entity id="corner0" position="0 0 0">
      <a-entity
        rotation="0 180 0"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner1" position="0 0 0">
      <a-entity
        rotation="0 90 0"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner2" position="0 0 0">
      <a-entity
        position="0 0 0"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner3" position="0 0 0">
      <a-entity
        rotation="0 270 0"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner4" position="0 0 0">
      <a-entity
        position="0 0 0"
        rotation="0 270 180"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner5" position="0 0 0">
      <a-entity
        rotation="0 180 180"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner6" position="0 0 0">
      <a-entity
        rotation="0 90 180"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

    <a-entity id="corner7" position="0 0 0">
      <a-entity
        rotation="0 0 180"
        mixin="m_c m_normal"
        class="clickable">
      </a-entity>
    </a-entity>

  </a-entity>

  <a-entity id="camera" sync-user="userId: userPosition" position="0 0 0" rotation="-30 30 0">
    <a-camera 
      id="camera2"
      camera-view="rayCube: #touch-cube; rayFace: #touch-face"
      look-controls-enabled="false"
      wasd-controls-enabled="false"
      position="0 0 10"
      fov="60">

      <a-entity
        id="touch-face"
        cursor="rayOrigin: mouse;"
        raycaster="objects: .ground; direction:0 0 -1">
      </a-entity>

      <a-entity
        id="touch-cube"
        cursor="rayOrigin: mouse;"
        raycaster="objects: .clickable; direction:0 0 -1">
      </a-entity>
    </a-camera>
  </a-entity>
</a-entity>

<a-box id="planeY" position="0 0 0" rotation="-90 0 0" width="50" height="50" depth="0.0001" color="#2950ee" material="opacity:0.3" visible="false">
</a-box>
<a-box id="planeX" position="0 0 0" rotation="0 90 0" width="50" height="50" depth="0.0001" color="#ff6600" material="opacity:0.3" visible="false">
</a-box>
<a-box id="planeZ" position="0 0 0" rotation="0 0 0" width="50" height="50" depth="0.0001" color="#00b500" material="opacity:0.3" visible="false">
</a-box>

    </a-scene>

    <div id="btn1" class="btn" style="text-align: center;">
      <p>Solve</p>
   </div>

    <div id="logs" class="text un-pointer-events"></div>

    <div id="sulves" class="text">
      <table>
        <tr>
          <th>Cross.1</th>
          <td></td>
        </tr>
        <tr>
          <th>Cross.2</th>
          <td></td>
        </tr>
        <tr>
          <th>Cross.3</th>
          <td></td>
        </tr>
        <tr>
          <th>Cross.4</th>
          <td></td>
        </tr>
        <tr>
          <th>D-C.1</th>
          <td></td>
        </tr>
        <tr>
          <th>D-C.2</th>
          <td></td>
        </tr>
        <tr>
          <th>D-C.3</th>
          <td></td>
        </tr>
        <tr>
          <th>D-C.4</th>
          <td></td>
        </tr>
        <tr>
          <th>E.1</th>
          <td></td>
        </tr>
        <tr>
          <th>E.2</th>
          <td></td>
        </tr>
        <tr>
          <th>E.3</th>
          <td></td>
        </tr>
        <tr>
          <th>E.4</th>
          <td></4d>
        </tr>
      </table>
    </div>

    <div id="ins-screen" class="ins-screen">
    </div>

    <iframe id="iframe" class="un-pointer-events" src="./index2.html" width="150" height="150"
    ></iframe>
    <div></div>
  </body >
</html>
